{"ast":null,"code":"import Vue from 'vue';\nimport Vuex from 'vuex';\nimport axios from 'axios';\nimport { API_BASE_URL } from '../config';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    cartProducts: [],\n    cartProductsData: [],\n    productLoading: true,\n    userAccessKey: null,\n    orderInfo: null\n  },\n  mutations: {\n    updateOrderInfo(state, orderInfo) {\n      state.orderInfo = orderInfo;\n    },\n\n    resetCart(state) {\n      state.cartProducts = [];\n      state.cartProductsData = [];\n    },\n\n    // addProductToCart(state, {productId, amount}) {\n    //   const item = state.cartProducts.find(\n    //     (item) => item.productId === productId\n    //   )\n    //   if (item) {\n    //     item.amount += amount\n    //   } else {\n    //     state.cartProducts.push({\n    //       productId,\n    //       amount,\n    //     })\n    //   }\n    // },\n    updateCartProductAmount(state, {\n      productId,\n      amount\n    }) {\n      const item = state.cartProducts.find(item => item.productId === productId);\n\n      if (item) {\n        item.amount = amount;\n      }\n    },\n\n    deletCartProduct(state, productId) {\n      state.cartProducts = state.cartProducts.filter(item => item.productId !== productId);\n    },\n\n    updateUserAccessKey(state, accessKey) {\n      state.userAccessKey = accessKey;\n    },\n\n    updateCartProductsData(state, items) {\n      const jsonData = items;\n      const parseData = JSON.parse(jsonData);\n      console.log(parseData);\n    },\n\n    syncCartProducts(state) {\n      state.cartProducts = state.cartProductsData.map(item => {\n        return {\n          productId: item.product.id,\n          amount: item.quantity\n        };\n      });\n    },\n\n    loadCartStatus(state, value) {\n      state.productLoading = value;\n    }\n\n  },\n  getters: {\n    cartDetailProducts(state) {\n      return state.cartProducts.map(item => {\n        const product = state.cartProductsData.find(p => p.product.id === item.productId).product;\n        return { ...item,\n          product: { ...product,\n            image: product.image.file.url\n          }\n        };\n      });\n    },\n\n    cartTotalPrice(state, getters) {\n      return getters.cartDetailProducts.reduce((acc, item) => item.product.price * item.amount + acc, 0);\n    }\n\n  },\n  actions: {\n    loadOrderInfo(context, orderId) {\n      return axios.get(API_BASE_URL + '/orders' / +orderId, {\n        params: {\n          userAccessKey: context.state.userAccessKey\n        }\n      }).then(response => {\n        context.commit('updateOrderInfo', response.data);\n      });\n    },\n\n    loadCart(context) {\n      return new Promise(resolve => setTimeout(resolve, 500)).then(() => {\n        return axios.get(API_BASE_URL + '/baskets', {\n          params: {\n            userAccessKey: context.state.userAccessKey\n          }\n        }).then(response => {\n          if (!context.state.userAccessKey) {\n            localStorage.setItem('userAccessKey', response.data.user.accessKey);\n            context.commit('updateUserAccessKey', response.data.user.accessKey);\n          }\n\n          context.commit('updateCartProductsData', response.data.items);\n          context.commit('syncCartProducts');\n          context.commit('loadCartStatus', false);\n        });\n      });\n    },\n\n    addProductToCart(context, {\n      productId,\n      amount\n    }) {\n      return new Promise(resolve => setTimeout(resolve, 2000)).then(() => {\n        return axios.post(API_BASE_URL + '/baskets/products', {\n          productId: productId,\n          quantity: amount\n        }, {\n          params: {\n            userAccessKey: context.state.userAccessKey\n          }\n        }).then(response => {\n          context.commit('updateCartProductsData', response.data.items);\n          context.commit('syncCartProducts');\n        });\n      });\n    },\n\n    updateCartProductAmount(context, {\n      productId,\n      amount\n    }) {\n      context.commit('updateCartProductAmount', {\n        productId,\n        amount\n      });\n\n      if (amount < 1) {\n        return;\n      }\n\n      return axios.put(API_BASE_URL + '/baskets/products', {\n        productId: productId,\n        quantity: amount\n      }, {\n        params: {\n          userAccessKey: context.state.userAccessKey\n        }\n      }).then(response => {\n        context.commit('updateCartProductsData', response.data.items);\n      }).catch(() => {\n        context.commit('syncCartProducts');\n      });\n    },\n\n    deletCartProduct(context, productId) {\n      context.commit('updateCartProductAmount', productId);\n      return axios.delete(API_BASE_URL + '/baskets/products', {\n        data: {\n          productId\n        },\n        params: {\n          userAccessKey: context.state.userAccessKey\n        }\n      }).then(response => {\n        context.commit('updateCartProductsData', response.data.items);\n        context.commit('syncCartProducts');\n      });\n    }\n\n  }\n});","map":{"version":3,"names":["Vue","Vuex","axios","API_BASE_URL","use","Store","state","cartProducts","cartProductsData","productLoading","userAccessKey","orderInfo","mutations","updateOrderInfo","resetCart","updateCartProductAmount","productId","amount","item","find","deletCartProduct","filter","updateUserAccessKey","accessKey","updateCartProductsData","items","jsonData","parseData","JSON","parse","console","log","syncCartProducts","map","product","id","quantity","loadCartStatus","value","getters","cartDetailProducts","p","image","file","url","cartTotalPrice","reduce","acc","price","actions","loadOrderInfo","context","orderId","get","params","then","response","commit","data","loadCart","Promise","resolve","setTimeout","localStorage","setItem","user","addProductToCart","post","put","catch","delete"],"sources":["/home/Kratos/Vs Code/vue-ishop/src/store/index.js"],"sourcesContent":["import Vue from 'vue'\nimport Vuex from 'vuex'\nimport axios from 'axios'\nimport {API_BASE_URL} from '../config'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  state: {\n    cartProducts: [],\n    cartProductsData: [],\n\n    productLoading: true,\n\n    userAccessKey: null,\n\n    orderInfo: null,\n  },\n\n  mutations: {\n    updateOrderInfo(state, orderInfo) {\n      state.orderInfo = orderInfo\n    },\n\n    resetCart(state) {\n      state.cartProducts = []\n      state.cartProductsData = []\n    },\n    // addProductToCart(state, {productId, amount}) {\n    //   const item = state.cartProducts.find(\n    //     (item) => item.productId === productId\n    //   )\n    //   if (item) {\n    //     item.amount += amount\n    //   } else {\n    //     state.cartProducts.push({\n    //       productId,\n    //       amount,\n    //     })\n    //   }\n    // },\n    updateCartProductAmount(state, {productId, amount}) {\n      const item = state.cartProducts.find(\n        (item) => item.productId === productId\n      )\n      if (item) {\n        item.amount = amount\n      }\n    },\n    deletCartProduct(state, productId) {\n      state.cartProducts = state.cartProducts.filter(\n        (item) => item.productId !== productId\n      )\n    },\n    updateUserAccessKey(state, accessKey) {\n      state.userAccessKey = accessKey\n    },\n    updateCartProductsData(state, items) {\n      const jsonData = items\n      const parseData = JSON.parse(jsonData)\n      console.log(parseData)\n    },\n    syncCartProducts(state) {\n      state.cartProducts = state.cartProductsData.map((item) => {\n        return {\n          productId: item.product.id,\n          amount: item.quantity,\n        }\n      })\n    },\n    loadCartStatus(state, value) {\n      state.productLoading = value\n    },\n  },\n\n  getters: {\n    cartDetailProducts(state) {\n      return state.cartProducts.map((item) => {\n        const product = state.cartProductsData.find(\n          (p) => p.product.id === item.productId\n        ).product\n\n        return {\n          ...item,\n          product: {\n            ...product,\n            image: product.image.file.url,\n          },\n        }\n      })\n    },\n    cartTotalPrice(state, getters) {\n      return getters.cartDetailProducts.reduce(\n        (acc, item) => item.product.price * item.amount + acc,\n        0\n      )\n    },\n  },\n\n  actions: {\n    loadOrderInfo(context, orderId) {\n        return axios\n          .get(API_BASE_URL + '/orders'/ + orderId, {\n            params: {\n              userAccessKey: context.state.userAccessKey,\n            },\n          })\n          .then(response => {\n            context.commit('updateOrderInfo', response.data)\n          })\n    },\n\n    loadCart(context) {\n      return new Promise((resolve) => setTimeout(resolve, 500)).then(() => {\n        return axios\n          .get(API_BASE_URL + '/baskets', {\n            params: {\n              userAccessKey: context.state.userAccessKey,\n            },\n          })\n          .then((response) => {\n            if (!context.state.userAccessKey) {\n              localStorage.setItem(\n                'userAccessKey',\n                response.data.user.accessKey\n              )\n              context.commit(\n                'updateUserAccessKey',\n                response.data.user.accessKey\n              )\n            }\n\n            context.commit('updateCartProductsData', response.data.items)\n            context.commit('syncCartProducts')\n            context.commit('loadCartStatus', false)\n          })\n      })\n    },\n    addProductToCart(context, {productId, amount}) {\n      return new Promise((resolve) => setTimeout(resolve, 2000)).then(() => {\n        return axios\n          .post(\n            API_BASE_URL + '/baskets/products',\n            {\n              productId: productId,\n              quantity: amount,\n            },\n            {\n              params: {\n                userAccessKey: context.state.userAccessKey,\n              },\n            }\n          )\n          .then((response) => {\n            context.commit('updateCartProductsData', response.data.items)\n            context.commit('syncCartProducts')\n          })\n      })\n    },\n    updateCartProductAmount(context, {productId, amount}) {\n      context.commit('updateCartProductAmount', {productId, amount})\n\n      if (amount < 1) {\n        return\n      }\n\n      return axios\n        .put(\n          API_BASE_URL + '/baskets/products',\n          {\n            productId: productId,\n            quantity: amount,\n          },\n          {\n            params: {\n              userAccessKey: context.state.userAccessKey,\n            },\n          }\n        )\n        .then((response) => {\n          context.commit('updateCartProductsData', response.data.items)\n        })\n        .catch(() => {\n          context.commit('syncCartProducts')\n        })\n    },\n    deletCartProduct(context, productId) {\n      context.commit('updateCartProductAmount', productId)\n\n      return axios\n        .delete(API_BASE_URL + '/baskets/products', {\n          data: {productId},\n          params: {\n            userAccessKey: context.state.userAccessKey,\n          },\n        })\n        .then((response) => {\n          context.commit('updateCartProductsData', response.data.items)\n          context.commit('syncCartProducts')\n        })\n    },\n  },\n})\n"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAAQC,YAAR,QAA2B,WAA3B;AAEAH,GAAG,CAACI,GAAJ,CAAQH,IAAR;AAEA,eAAe,IAAIA,IAAI,CAACI,KAAT,CAAe;EAC5BC,KAAK,EAAE;IACLC,YAAY,EAAE,EADT;IAELC,gBAAgB,EAAE,EAFb;IAILC,cAAc,EAAE,IAJX;IAMLC,aAAa,EAAE,IANV;IAQLC,SAAS,EAAE;EARN,CADqB;EAY5BC,SAAS,EAAE;IACTC,eAAe,CAACP,KAAD,EAAQK,SAAR,EAAmB;MAChCL,KAAK,CAACK,SAAN,GAAkBA,SAAlB;IACD,CAHQ;;IAKTG,SAAS,CAACR,KAAD,EAAQ;MACfA,KAAK,CAACC,YAAN,GAAqB,EAArB;MACAD,KAAK,CAACE,gBAAN,GAAyB,EAAzB;IACD,CARQ;;IAST;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAO,uBAAuB,CAACT,KAAD,EAAQ;MAACU,SAAD;MAAYC;IAAZ,CAAR,EAA6B;MAClD,MAAMC,IAAI,GAAGZ,KAAK,CAACC,YAAN,CAAmBY,IAAnB,CACVD,IAAD,IAAUA,IAAI,CAACF,SAAL,KAAmBA,SADlB,CAAb;;MAGA,IAAIE,IAAJ,EAAU;QACRA,IAAI,CAACD,MAAL,GAAcA,MAAd;MACD;IACF,CA7BQ;;IA8BTG,gBAAgB,CAACd,KAAD,EAAQU,SAAR,EAAmB;MACjCV,KAAK,CAACC,YAAN,GAAqBD,KAAK,CAACC,YAAN,CAAmBc,MAAnB,CAClBH,IAAD,IAAUA,IAAI,CAACF,SAAL,KAAmBA,SADV,CAArB;IAGD,CAlCQ;;IAmCTM,mBAAmB,CAAChB,KAAD,EAAQiB,SAAR,EAAmB;MACpCjB,KAAK,CAACI,aAAN,GAAsBa,SAAtB;IACD,CArCQ;;IAsCTC,sBAAsB,CAAClB,KAAD,EAAQmB,KAAR,EAAe;MACnC,MAAMC,QAAQ,GAAGD,KAAjB;MACA,MAAME,SAAS,GAAGC,IAAI,CAACC,KAAL,CAAWH,QAAX,CAAlB;MACAI,OAAO,CAACC,GAAR,CAAYJ,SAAZ;IACD,CA1CQ;;IA2CTK,gBAAgB,CAAC1B,KAAD,EAAQ;MACtBA,KAAK,CAACC,YAAN,GAAqBD,KAAK,CAACE,gBAAN,CAAuByB,GAAvB,CAA4Bf,IAAD,IAAU;QACxD,OAAO;UACLF,SAAS,EAAEE,IAAI,CAACgB,OAAL,CAAaC,EADnB;UAELlB,MAAM,EAAEC,IAAI,CAACkB;QAFR,CAAP;MAID,CALoB,CAArB;IAMD,CAlDQ;;IAmDTC,cAAc,CAAC/B,KAAD,EAAQgC,KAAR,EAAe;MAC3BhC,KAAK,CAACG,cAAN,GAAuB6B,KAAvB;IACD;;EArDQ,CAZiB;EAoE5BC,OAAO,EAAE;IACPC,kBAAkB,CAAClC,KAAD,EAAQ;MACxB,OAAOA,KAAK,CAACC,YAAN,CAAmB0B,GAAnB,CAAwBf,IAAD,IAAU;QACtC,MAAMgB,OAAO,GAAG5B,KAAK,CAACE,gBAAN,CAAuBW,IAAvB,CACbsB,CAAD,IAAOA,CAAC,CAACP,OAAF,CAAUC,EAAV,KAAiBjB,IAAI,CAACF,SADf,EAEdkB,OAFF;QAIA,OAAO,EACL,GAAGhB,IADE;UAELgB,OAAO,EAAE,EACP,GAAGA,OADI;YAEPQ,KAAK,EAAER,OAAO,CAACQ,KAAR,CAAcC,IAAd,CAAmBC;UAFnB;QAFJ,CAAP;MAOD,CAZM,CAAP;IAaD,CAfM;;IAgBPC,cAAc,CAACvC,KAAD,EAAQiC,OAAR,EAAiB;MAC7B,OAAOA,OAAO,CAACC,kBAAR,CAA2BM,MAA3B,CACL,CAACC,GAAD,EAAM7B,IAAN,KAAeA,IAAI,CAACgB,OAAL,CAAac,KAAb,GAAqB9B,IAAI,CAACD,MAA1B,GAAmC8B,GAD7C,EAEL,CAFK,CAAP;IAID;;EArBM,CApEmB;EA4F5BE,OAAO,EAAE;IACPC,aAAa,CAACC,OAAD,EAAUC,OAAV,EAAmB;MAC5B,OAAOlD,KAAK,CACTmD,GADI,CACAlD,YAAY,GAAG,YAAW,CAAEiD,OAD5B,EACqC;QACxCE,MAAM,EAAE;UACN5C,aAAa,EAAEyC,OAAO,CAAC7C,KAAR,CAAcI;QADvB;MADgC,CADrC,EAMJ6C,IANI,CAMCC,QAAQ,IAAI;QAChBL,OAAO,CAACM,MAAR,CAAe,iBAAf,EAAkCD,QAAQ,CAACE,IAA3C;MACD,CARI,CAAP;IASH,CAXM;;IAaPC,QAAQ,CAACR,OAAD,EAAU;MAChB,OAAO,IAAIS,OAAJ,CAAaC,OAAD,IAAaC,UAAU,CAACD,OAAD,EAAU,GAAV,CAAnC,EAAmDN,IAAnD,CAAwD,MAAM;QACnE,OAAOrD,KAAK,CACTmD,GADI,CACAlD,YAAY,GAAG,UADf,EAC2B;UAC9BmD,MAAM,EAAE;YACN5C,aAAa,EAAEyC,OAAO,CAAC7C,KAAR,CAAcI;UADvB;QADsB,CAD3B,EAMJ6C,IANI,CAMEC,QAAD,IAAc;UAClB,IAAI,CAACL,OAAO,CAAC7C,KAAR,CAAcI,aAAnB,EAAkC;YAChCqD,YAAY,CAACC,OAAb,CACE,eADF,EAEER,QAAQ,CAACE,IAAT,CAAcO,IAAd,CAAmB1C,SAFrB;YAIA4B,OAAO,CAACM,MAAR,CACE,qBADF,EAEED,QAAQ,CAACE,IAAT,CAAcO,IAAd,CAAmB1C,SAFrB;UAID;;UAED4B,OAAO,CAACM,MAAR,CAAe,wBAAf,EAAyCD,QAAQ,CAACE,IAAT,CAAcjC,KAAvD;UACA0B,OAAO,CAACM,MAAR,CAAe,kBAAf;UACAN,OAAO,CAACM,MAAR,CAAe,gBAAf,EAAiC,KAAjC;QACD,CArBI,CAAP;MAsBD,CAvBM,CAAP;IAwBD,CAtCM;;IAuCPS,gBAAgB,CAACf,OAAD,EAAU;MAACnC,SAAD;MAAYC;IAAZ,CAAV,EAA+B;MAC7C,OAAO,IAAI2C,OAAJ,CAAaC,OAAD,IAAaC,UAAU,CAACD,OAAD,EAAU,IAAV,CAAnC,EAAoDN,IAApD,CAAyD,MAAM;QACpE,OAAOrD,KAAK,CACTiE,IADI,CAEHhE,YAAY,GAAG,mBAFZ,EAGH;UACEa,SAAS,EAAEA,SADb;UAEEoB,QAAQ,EAAEnB;QAFZ,CAHG,EAOH;UACEqC,MAAM,EAAE;YACN5C,aAAa,EAAEyC,OAAO,CAAC7C,KAAR,CAAcI;UADvB;QADV,CAPG,EAaJ6C,IAbI,CAaEC,QAAD,IAAc;UAClBL,OAAO,CAACM,MAAR,CAAe,wBAAf,EAAyCD,QAAQ,CAACE,IAAT,CAAcjC,KAAvD;UACA0B,OAAO,CAACM,MAAR,CAAe,kBAAf;QACD,CAhBI,CAAP;MAiBD,CAlBM,CAAP;IAmBD,CA3DM;;IA4DP1C,uBAAuB,CAACoC,OAAD,EAAU;MAACnC,SAAD;MAAYC;IAAZ,CAAV,EAA+B;MACpDkC,OAAO,CAACM,MAAR,CAAe,yBAAf,EAA0C;QAACzC,SAAD;QAAYC;MAAZ,CAA1C;;MAEA,IAAIA,MAAM,GAAG,CAAb,EAAgB;QACd;MACD;;MAED,OAAOf,KAAK,CACTkE,GADI,CAEHjE,YAAY,GAAG,mBAFZ,EAGH;QACEa,SAAS,EAAEA,SADb;QAEEoB,QAAQ,EAAEnB;MAFZ,CAHG,EAOH;QACEqC,MAAM,EAAE;UACN5C,aAAa,EAAEyC,OAAO,CAAC7C,KAAR,CAAcI;QADvB;MADV,CAPG,EAaJ6C,IAbI,CAaEC,QAAD,IAAc;QAClBL,OAAO,CAACM,MAAR,CAAe,wBAAf,EAAyCD,QAAQ,CAACE,IAAT,CAAcjC,KAAvD;MACD,CAfI,EAgBJ4C,KAhBI,CAgBE,MAAM;QACXlB,OAAO,CAACM,MAAR,CAAe,kBAAf;MACD,CAlBI,CAAP;IAmBD,CAtFM;;IAuFPrC,gBAAgB,CAAC+B,OAAD,EAAUnC,SAAV,EAAqB;MACnCmC,OAAO,CAACM,MAAR,CAAe,yBAAf,EAA0CzC,SAA1C;MAEA,OAAOd,KAAK,CACToE,MADI,CACGnE,YAAY,GAAG,mBADlB,EACuC;QAC1CuD,IAAI,EAAE;UAAC1C;QAAD,CADoC;QAE1CsC,MAAM,EAAE;UACN5C,aAAa,EAAEyC,OAAO,CAAC7C,KAAR,CAAcI;QADvB;MAFkC,CADvC,EAOJ6C,IAPI,CAOEC,QAAD,IAAc;QAClBL,OAAO,CAACM,MAAR,CAAe,wBAAf,EAAyCD,QAAQ,CAACE,IAAT,CAAcjC,KAAvD;QACA0B,OAAO,CAACM,MAAR,CAAe,kBAAf;MACD,CAVI,CAAP;IAWD;;EArGM;AA5FmB,CAAf,CAAf"},"metadata":{},"sourceType":"module"}