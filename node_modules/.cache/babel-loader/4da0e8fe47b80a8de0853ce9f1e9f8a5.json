{"ast":null,"code":"import AppProductList from '@/components/ProductList.vue';\nimport AppBasePagination from '@/components/BasePagination.vue';\nimport AppProductFilter from '@/components/ProductFilter.vue';\nimport axios from 'axios';\nimport { API_BASE_URL } from '../config';\nexport default {\n  name: 'AppMainPage',\n  components: {\n    AppProductList,\n    AppBasePagination,\n    AppProductFilter\n  },\n\n  data() {\n    return {\n      filterPriceFrom: 0,\n      filterPriceTo: 0,\n      filterCategoryId: 0,\n      startColor: 0,\n      page: 1,\n      productsPerPage: 6,\n      productsData: null\n    };\n  },\n\n  computed: {\n    // filteredProducts() {\n    //   let filteredProducts = products\n    //   if (this.filterPriceFrom > 0) {\n    //     filteredProducts = filteredProducts.filter(\n    //       (product) => product.price > this.filterPriceFrom\n    //     )\n    //   }\n    //   if (this.filterPriceTo > 0) {\n    //     filteredProducts = filteredProducts.filter(\n    //       (product) => product.price < this.filterPriceTo\n    //     )\n    //   }\n    //   if (this.filterCategoryId > 0) {\n    //     filteredProducts = filteredProducts.filter(\n    //       (product) => product.categoryId === this.filterCategoryId\n    //     )\n    //   }\n    //   if (this.startColor && this.startColor.length) {\n    //     filteredProducts = filteredProducts.filter(\n    //       (product) => product.colors.indexOf(this.startColor) > -1\n    //     )\n    //   }\n    //   return filteredProducts\n    // },\n    // colors() {\n    //   return this.startColor ? this.startColor.items : []\n    // },\n    products() {\n      //код для вывода из локальных данных\n      // const offset = (this.page - 1) * this.productsPerPage\n      // return this.filteredProducts.slice(offset, offset + this.productsPerPage)\n      return this.productsData ? this.productsData.data.items.map(product => {\n        return { ...product,\n          image: product.image.file.url // colors: product.colors\n\n        };\n      }) : [];\n    },\n\n    countProducts() {\n      // return this.filteredProducts.length\n      return this.productsData ? this.productsData.data.pagination.total : 0;\n    } // eslint-disable-next-line vue/no-dupe-keys\n    // startColor() {\n    //   return this.productsData ? this.productsData.data.items.colors : 0\n    // },\n\n\n  },\n  methods: {\n    loadProducts() {\n      clearTimeout(this.loadProductsTimer);\n      this.loadProductsTimer = setTimeout(() => {\n        axios.get(API_BASE_URL + '/products', {\n          params: {\n            page: this.page,\n            limit: this.productsPerPage,\n            categoryId: this.filterCategoryId,\n            minPrice: this.filterPriceFrom,\n            maxPrice: this.filterPriceTo,\n            colorId: this.startColor\n          }\n        }).then(response => this.productsData = response);\n      }, 0);\n    } // loadColor() {\n    //   axios\n    //     .get('https://vue-study.skillbox.cc/api/colors')\n    //     .then((response) => (this.startColor = response))\n    // },\n\n\n  },\n\n  created() {\n    this.loadProducts(); // this.loadColor()\n  },\n\n  watch: {\n    page() {\n      this.loadProducts();\n    },\n\n    filterPriceFrom() {\n      this.loadProducts();\n    },\n\n    filterPriceTo() {\n      this.loadProducts();\n    },\n\n    filterCategoryId() {\n      this.loadProducts();\n    },\n\n    startColor() {\n      this.loadProducts(); // this.loadColor()\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA6BA;AACA;AACA;AACA;AACA;AAEA;EACAA,mBADA;EAEAC;IACAC,cADA;IAEAC,iBAFA;IAGAC;EAHA,CAFA;;EAQAC;IACA;MACAC,kBADA;MAEAC,gBAFA;MAGAC,mBAHA;MAIAC,aAJA;MAMAC,OANA;MAOAC,kBAPA;MASAC;IATA;EAWA,CApBA;;EAsBAC;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IAGA;IACA;IACA;IACAC;MACA;MACA;MACA;MAEA,2BACA;QACA,SACA,UADA;UAEAC,6BAFA,CAGA;;QAHA;MAKA,CANA,CADA,GAQA,EARA;IASA,CA9CA;;IA+CAC;MACA;MAEA;IACA,CAnDA,CAoDA;IACA;IACA;IACA;;;EAvDA,CAtBA;EAgFAC;IACAC;MACAC;MACA;QACAC,MACAC,GADA,CACAC,0BADA,EACA;UACAC;YACAb,eADA;YAEAc,2BAFA;YAGAC,iCAHA;YAIAC,8BAJA;YAKAC,4BALA;YAMAC;UANA;QADA,CADA,EAWAC,IAXA,CAWAC,wCAXA;MAYA,CAbA,EAaA,CAbA;IAcA,CAjBA,CAkBA;IACA;IACA;IACA;IACA;;;EAtBA,CAhFA;;EAyGAC;IACA,oBADA,CAEA;EACA,CA5GA;;EA8GAC;IACAtB;MACA;IACA,CAHA;;IAIAJ;MACA;IACA,CANA;;IAOAC;MACA;IACA,CATA;;IAUAC;MACA;IACA,CAZA;;IAaAC;MACA,oBADA,CAEA;IACA;;EAhBA;AA9GA","names":["name","components","AppProductList","AppBasePagination","AppProductFilter","data","filterPriceFrom","filterPriceTo","filterCategoryId","startColor","page","productsPerPage","productsData","computed","products","image","countProducts","methods","loadProducts","clearTimeout","axios","get","API_BASE_URL","params","limit","categoryId","minPrice","maxPrice","colorId","then","response","created","watch"],"sourceRoot":"src/pages","sources":["MainPage.vue"],"sourcesContent":["<template>\n  <main class=\"content container\">\n    <div class=\"content__top content__top--catalog\">\n      <h1 class=\"content__title\">Каталог</h1>\n      <span class=\"content__info\"> 152 товара </span>\n    </div>\n\n    <div class=\"content__catalog\">\n      <app-product-filter\n        :price-from.sync=\"filterPriceFrom\"\n        :price-to.sync=\"filterPriceTo\"\n        :category-id.sync=\"filterCategoryId\"\n        :start-color.sync=\"startColor\"\n      ></app-product-filter>\n\n      <section class=\"catalog\">\n        <app-product-list :products=\"products\"></app-product-list>\n\n        <app-base-pagination\n          v-model=\"page\"\n          :count=\"countProducts\"\n          :per-page=\"productsPerPage\"\n        ></app-base-pagination>\n      </section>\n    </div>\n  </main>\n</template>\n\n<script>\nimport AppProductList from '@/components/ProductList.vue'\nimport AppBasePagination from '@/components/BasePagination.vue'\nimport AppProductFilter from '@/components/ProductFilter.vue'\nimport axios from 'axios'\nimport {API_BASE_URL} from '../config'\n\nexport default {\n  name: 'AppMainPage',\n  components: {\n    AppProductList,\n    AppBasePagination,\n    AppProductFilter,\n  },\n\n  data() {\n    return {\n      filterPriceFrom: 0,\n      filterPriceTo: 0,\n      filterCategoryId: 0,\n      startColor: 0,\n\n      page: 1,\n      productsPerPage: 6,\n\n      productsData: null,\n    }\n  },\n\n  computed: {\n    // filteredProducts() {\n    //   let filteredProducts = products\n\n    //   if (this.filterPriceFrom > 0) {\n    //     filteredProducts = filteredProducts.filter(\n    //       (product) => product.price > this.filterPriceFrom\n    //     )\n    //   }\n    //   if (this.filterPriceTo > 0) {\n    //     filteredProducts = filteredProducts.filter(\n    //       (product) => product.price < this.filterPriceTo\n    //     )\n    //   }\n    //   if (this.filterCategoryId > 0) {\n    //     filteredProducts = filteredProducts.filter(\n    //       (product) => product.categoryId === this.filterCategoryId\n    //     )\n    //   }\n    //   if (this.startColor && this.startColor.length) {\n    //     filteredProducts = filteredProducts.filter(\n    //       (product) => product.colors.indexOf(this.startColor) > -1\n    //     )\n    //   }\n\n    //   return filteredProducts\n    // },\n\n\n    // colors() {\n    //   return this.startColor ? this.startColor.items : []\n    // },\n    products() {\n      //код для вывода из локальных данных\n      // const offset = (this.page - 1) * this.productsPerPage\n      // return this.filteredProducts.slice(offset, offset + this.productsPerPage)\n\n      return this.productsData\n        ? this.productsData.data.items.map((product) => {\n            return {\n              ...product,\n              image: product.image.file.url,\n              // colors: product.colors\n            }\n          })\n        : []\n    },\n    countProducts() {\n      // return this.filteredProducts.length\n\n      return this.productsData ? this.productsData.data.pagination.total : 0\n    },\n    // eslint-disable-next-line vue/no-dupe-keys\n    // startColor() {\n    //   return this.productsData ? this.productsData.data.items.colors : 0\n    // },\n  },\n\n  methods: {\n    loadProducts() {\n      clearTimeout(this.loadProductsTimer)\n      this.loadProductsTimer = setTimeout(() => {\n        axios\n        .get(API_BASE_URL + '/products', {\n          params: {\n            page: this.page,\n            limit: this.productsPerPage,\n            categoryId: this.filterCategoryId,\n            minPrice: this.filterPriceFrom,\n            maxPrice: this.filterPriceTo,\n            colorId: this.startColor,\n          },\n        })\n        .then((response) => (this.productsData = response))\n      },0)\n    },\n    // loadColor() {\n    //   axios\n    //     .get('https://vue-study.skillbox.cc/api/colors')\n    //     .then((response) => (this.startColor = response))\n    // },\n  },\n\n  created() {\n    this.loadProducts()\n    // this.loadColor()\n  },\n\n  watch: {\n    page() {\n      this.loadProducts()\n    },\n    filterPriceFrom() {\n      this.loadProducts()\n    },\n    filterPriceTo() {\n      this.loadProducts()\n    },\n    filterCategoryId() {\n      this.loadProducts()\n    },\n    startColor() {\n      this.loadProducts()\n      // this.loadColor()\n    },\n  },\n}\n</script>\n\n<style scoped></style>\n"]},"metadata":{},"sourceType":"module"}